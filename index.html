<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom Binary Tree & LCA Visualizer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .node-circle {
      transition: all 0.3s ease;
      fill: #fff;
      stroke: #2d3748;
      stroke-width: 2px;
    }
    .highlighted {
      fill: #90cdf4;
    }
  </style>
</head>
<body class="bg-blue-50 min-h-screen py-8 px-4">
  <div class="max-w-4xl mx-auto">
    <header class="text-center mb-6">
      <h1 class="text-3xl font-bold text-blue-800">Custom Binary Tree Builder & LCA Finder</h1>
      <p class="text-gray-600">Choose where to place each node and find their Lowest Common Ancestor</p>
    </header>

    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
      <div class="flex flex-wrap gap-3 items-center justify-center mb-4">
        <input type="number" id="nodeInput" placeholder="New node value" class="border p-2 rounded-md w-36" />
        <input type="number" id="parentInput" placeholder="Parent node value" class="border p-2 rounded-md w-36" />
        <select id="directionInput" class="border p-2 rounded-md">
          <option value="left">Left Child</option>
          <option value="right">Right Child</option>
        </select>
        <button onclick="insertNode()" class="bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600">Insert Node</button>
      </div>

      <div class="flex flex-wrap gap-3 items-center justify-center mb-4">
        <input type="number" id="lcaNode1" placeholder="LCA node 1" class="border p-2 rounded-md w-36" />
        <input type="number" id="lcaNode2" placeholder="LCA node 2" class="border p-2 rounded-md w-36" />
        <button onclick="handleFindLCA()" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">Find LCA</button>
      </div>

      <div id="result" class="text-lg text-center text-blue-700 font-semibold"></div>
    </div>

    <svg id="treeCanvas" width="100%" height="400"></svg>
  </div>

  <script>
    class TreeNode {
      constructor(value) {
        this.value = value;
        this.left = null;
        this.right = null;
        this.x = 0;
        this.y = 0;
      }
    }

    let root = null;
    const radius = 20;
    const levelHeight = 70;
    const canvas = document.getElementById("treeCanvas");

    function insertNode() {
      const value = parseInt(document.getElementById("nodeInput").value);
      const parentValue = document.getElementById("parentInput").value;
      const direction = document.getElementById("directionInput").value;

      if (isNaN(value)) return alert("Please enter a valid node value");

      if (!parentValue) {
        if (root !== null) {
          alert("Root already exists!");
          return;
        }
        root = new TreeNode(value);
      } else {
        const parent = findNode(root, parseInt(parentValue));
        if (!parent) {
          alert("Parent node not found!");
          return;
        }

        if (direction === 'left') {
          if (parent.left) return alert("Left child already exists for this parent");
          parent.left = new TreeNode(value);
        } else {
          if (parent.right) return alert("Right child already exists for this parent");
          parent.right = new TreeNode(value);
        }
      }

      drawTree();
      document.getElementById("nodeInput").value = "";
      document.getElementById("parentInput").value = "";
    }

    function findNode(node, value) {
      if (!node) return null;
      if (node.value === value) return node;
      return findNode(node.left, value) || findNode(node.right, value);
    }

    function calculatePositions(node, x, y, offset) {
      if (!node) return;
      node.x = x;
      node.y = y;
      calculatePositions(node.left, x - offset, y + levelHeight, offset / 2);
      calculatePositions(node.right, x + offset, y + levelHeight, offset / 2);
    }

    function drawTree() {
      canvas.innerHTML = "";
      if (!root) return;
      calculatePositions(root, canvas.clientWidth / 2, 40, canvas.clientWidth / 4);
      drawConnections(root);
      drawNodes(root);
    }

    function drawConnections(node) {
      if (node.left) drawLine(node, node.left);
      if (node.right) drawLine(node, node.right);
      if (node.left) drawConnections(node.left);
      if (node.right) drawConnections(node.right);
    }

    function drawLine(from, to) {
      const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
      line.setAttribute("x1", from.x);
      line.setAttribute("y1", from.y);
      line.setAttribute("x2", to.x);
      line.setAttribute("y2", to.y);
      line.setAttribute("stroke", "#4a5568");
      line.setAttribute("stroke-width", "2");
      canvas.appendChild(line);
    }

    function drawNodes(node) {
      const group = document.createElementNS("http://www.w3.org/2000/svg", "g");

      const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
      circle.setAttribute("cx", node.x);
      circle.setAttribute("cy", node.y);
      circle.setAttribute("r", radius);
      circle.setAttribute("class", "node-circle");
      group.appendChild(circle);

      const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
      text.setAttribute("x", node.x);
      text.setAttribute("y", node.y + 5);
      text.setAttribute("text-anchor", "middle");
      text.setAttribute("font-size", "14px");
      text.setAttribute("fill", "#2d3748");
      text.textContent = node.value;
      group.appendChild(text);

      canvas.appendChild(group);

      if (node.left) drawNodes(node.left);
      if (node.right) drawNodes(node.right);
    }

    function findLCA(node, n1, n2) {
      if (!node) return null;
      if (node.value === n1 || node.value === n2) return node;

      const left = findLCA(node.left, n1, n2);
      const right = findLCA(node.right, n1, n2);

      if (left && right) return node;
      return left || right;
    }

    function handleFindLCA() {
      const n1 = parseInt(document.getElementById("lcaNode1").value);
      const n2 = parseInt(document.getElementById("lcaNode2").value);
      if (isNaN(n1) || isNaN(n2)) return;

      const lca = findLCA(root, n1, n2);
      if (lca) {
        document.getElementById("result").innerText = `LCA of ${n1} and ${n2} is: ${lca.value}`;
      } else {
        document.getElementById("result").innerText = `One or both nodes not found.`;
      }
    }
  </script>
</body>
</html>